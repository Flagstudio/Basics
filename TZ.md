# ТЗ и декомпозиция

## Мишина лекция про то, как писать ТЗ и разбивать проект на задачи

[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/yvm3Lt29-kk/0.jpg)](http://www.youtube.com/watch?v=yvm3Lt29-kk)

## Общие моменты

Откровенно говоря, эта страница описывает не только написание ТЗ, но и процесс декомпозиции задачи и проектирования систем. Эти знания пригодятся вам еще и при осмечивании проекта, например.

### MVC

Основные части технического задания:
- Структура данных (Model)
- Страницы и их описание (View)
- Функционал (Controller)

### Общие разделы ТЗ

Также в ТЗ включаются служебные блоки, такие как
- Оглавление, терминология, основание для разработки
- Требования к серверу
  - ПО
  - Железо
- Требования к браузерам/ОС пользователей Desktop
- Требования к браузерам/ОС пользователей Mobile
- Требования по доступности (масштаб, валидность, читалки, скорость загрузки и тд)
- Языковые версии сайта
- Роли пользователей

### Agile

В Agile постановка задач делается в виде "As a … I want … so …".

Например, как редактор новостей, я хочу, чтобы у новости была кнопка "редактировать", чтобы я мог нажать на нее и отредактировать.

То есть, параметрами задачи являются:
- Роль и состояние пользователя
- Бизнес-задача
- Имплементация

### CRUD

В программировании есть хороший паттерн CRUD. Create, Read, Update, Delete.
Многие программисты рассматривают его только как управление справочниками в админке, **но** это не верно. CRUD может дать вам гораздо больше как для декомпозиции проекта, так и для создания его архитектуры.

рПочти все приложения можно представить в виде CRUD. Тогда реализовать их становится гораздо проще.

Например, что такое чекаут в интернет-магазине? Особая функциональность? Нет, это **create** для модели **Заказ**.

Хотите пожеще? Что такое авторизация? Это **create** для модели **Сессия Пользователя**.

И так далее. Конечно, про сессии это уже перебор, но общую мысль вы уловили. Почти весь функицонал хорошо ложится в CRUD.

Как это использовать? CRUD хорошо помогает при определениии функицонала (C) и выводов (страниц, V). Вам будет проще вспомнить или прдумать нужный функционал и декомпозировать запутанные сценарии.

### KISS

Еще один принцип, используемый программистами - KISS. Keep it stupid sipmle. Чем проще, тем лучше. Не надо делать круто и технологично, надо делать просто. Если вашу системы трудно понять, подумайте. Может ее надо описать как CRUD? CRUD легко понять. Короче, упрощайте, вам за это платят клиенты.

### DRY

ОЧень полезный принцип программирования, который стоит взять на вооружение. DRY — это Don't Repeat Yourself.

> {primary} При написании ТЗ нужно **как можно меньше** копипастить текст.

Если вы повторяетесь, постарайтесь вынести повторение в отдельный раздел и ссылаться на него, там где это нужно. Тогда ваше ТЗ будет гораздо проще читать и в вам будет легче вносить в ТЗ исправления. Давайте я объясню.

Легче читать, потому что читатель будет получать только уникальную информацию, а не повторяющиеся блоки текста. ТАкие повторы он начнет пропускать, вместе с этим, вполне вероятно, пропуская незаметные, но важные изменения.

Насчет исправлений, тут причина та же, что и в программировании. Вы повторяет одно и то же. ЗАтем вам нужно это имзенить. Вы меняете это в нескольких местах. Забываете про одно из мест. И тут ваше ТЗ начинает противоречить самому себе.

## Страницы и их описание (View)

### Если нет дизайна/прототипов

Иногда, нужно описать функциональность без прототипа и без дизайна. Обычно, это нужно на этапе оценки.
В таком случае вы можете запомнить, как легко выделеить задачи типа View, они похожи:
- Страница листинга элементов. Например, каталог товаров или список новостей
- Страница карточки элемента. Например, карточка товара
- Блоки вывода. Например, блок популярных товаров на главной странице или блок похожих товаров на карточке товара. Да, это лучше вынести в отдельную задачу из карточки товара

### Про вставку дизайнов/прототипов

Если у вас есть дизайн, вставляете в ТЗ картинки дизайна. Если нет дизайна, то вставляете прототипы. **Не надо вставлять ссылки** на прототипы или дизайны на внешних ресурсах. Если очень хочется, то можно, но картинки должны быть прямо вставлены в документ тоже. Потому что контент на внешних ссылках может измениться, а вставленная в документ картинка не может.

### Как описывать прототипы

> {primary}  **Не нужно** описывать в прототипах очевидные вещи.

Такого бумагомарательства можно наделать очень много и в нем уже нельзя будет разглядеть что-то важное. Пишите то, что не очевидно на прототипе, например:

- Что является кликабельным элементом, а что нет. Что произойдет по клику
- Также описать, если что-то происходит при наведении курсора на элемент
- Также описать, если элементы как то реагируют на скролинг (прилипают к окну, анимируются, пропадают)
- Как будет выглядеть тот или иной набор элементов (список товаров, новостей), если в нем **не будет** элементов или их будет мало. Или, если в каком то элементе будет слишком много текста или слишком большая картинка
- Наоборот, как будет выглядеть набор элементов или элемент, в котором слишком много контента (наприме, в каталоге товаров описания товаров могут скрываться или обрезаться)
- Описать попапы
- Описать галереи
- **ВАЖНО**. Описать, чем будет отличаться страница и ее функционал для разных ролей пользователей
- Описать в чем будет отличие для страниц сущностей в разных состояниях. Например, список заказов в разных статусах, карточка товара в наличии и не в наличии

### ФОС (Формы Обратной Связи)

Описать:
- Валидацию полей
  - Необходимость заполнения полей
  - Минимальная/максимальна длина поля
  - Допустимые символы (например, только цифры)
  - Соответствие регулярному выражению (например, регулярка для емейла)
  - Кому уходит письмо (обычно, админу и отправителю)
  - Куда еще сохраняется письмо (CRM, БД, логи и тд)
- Маски полей
- Куда попадаем после отправки формы
- Обработка ошибки отправки сервером

Сперва опишите общие блоки, такие как шапка и подвал.


>  Не надо в описании прототипов описывать бизнес-логику.

Надо ссылаться на соответствующие разделы в "Функциональных возможностях". Например, логику расчета рейтинга не надо описывать на странице списка исполнителей, но надо сослаться на описание этой логики. Так у вас не будет дублирования описания бизнес-логики и вы избежите разсинхронизации (в одном месте изменили логику, а вдругом забыли).

## Структура данных (Model)

Для понимания организации данных в системе рекомендую ознакомиться с разделом [описание БД](DB.md).

- Сущности
- Свойства (основные)
  - Строка
  - Текст
  - Число целое
  - Число с плавающей точкой
  - Дата (ДатаВремя)
  - Булево (да/нет)
  - enum (выбор из набора вариантов)
  - json (объект с любой вложенностью)
- Статусы, жизненный цикл
- Связи
  - 1 к 1
  - 1 ко многим
  - многие ко многим
  - морфы 1 ко многим
  - морфы многие ко многим

  > {primary} Опасайтесь избыточных связей.

Избыточные связи, как шестеренки, блокируют систему. Например, вы делаете систему для кинотеатра. Нельзя делать связь Зритель-Фильм, если есть модель Билет. Вы должны пользоваться существующими связями, чтобы добраться от зрителя до фильма, например так: Зритель-Билет-Сеанс-Фильм. В противном случае, у вас будут большие проблемы.


## Функционал (Controller)

Во-первых, CRUD, о котором я писал выше.
Во-вторых, есть функицональности, которые часто используются на проектах, а именно **для каждой модели**:

- Нотификации
  - E-mail
  - SMS
  - Мессенджеры
  - Уведомления на сайте
- Разрешения. Доступность тех или иных функций для разных ролей и состояний пользователей
- Роутинг. Описание URL-адресов сайта. Может потребоваться для SEO. **Обязательно** советоваться с бэкенд-разработчиками при описании URL-ов на сайте
- Импорт/экспорт данных. Подробнее опишу ниже
  - Тип: разовый, триггерный, синхронизация
  - Откуда/куда импорт/экспорт. Документация внешней системы
  - Какие поля модели синхронизируются
  - Что происходит при добавлении новых единиц, удалении старых
  - Вывод ошибок и логи
- Поиск
- Фильтры/сортировки на листингах
- Админка

## Базовые правила в нашем ТЗ

- Админка на наше усмотрение. Клиент дает бизнес-задачу по админке (чего хочет добиться), мы сами подбираем решение
- Все, что не описано в ТЗ, остается на наше усотрение
- Функциональный модуль считается реализованным, если посетитель сайта может им воспользоваться.
- Функциональность, зависящая от интеграций со сторонними сервисами, может корректироваться Исполнителем в ходе работы. Все форс-мажоры интеграций с внешними системами финансово ложатся на клиента.

## Частности WIP
Если есть ЛК, то должно быть
- регистрация
- Авторизация
- Редактирование учетных данных юзера
- Смена пароля
- Напомнить пароль (Забыли пароль?)
- Справа вверху блок авторизации
